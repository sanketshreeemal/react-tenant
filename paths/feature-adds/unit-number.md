# Steps to Fix the Bug: Saving the unitNumber

This guide explains how to reliably capture and save the `unitNumber` from the selected unit object when a unit is chosen in the form. Follow these steps carefully to update your code.

---

## Step 1: Modify the RentalInventory Interface

*Optional but recommended for clarity.*

1. In your `types.d.ts`, update the `RentalInventory` interface to clearly separate the document ID and the unitNumber:

    ```typescript
    // Interface for Rental Inventory Data
    export interface RentalInventory {
      id?: string; // Document ID (auto-generated by Firestore) - optional
      unitNumber: string; // Unique identifier for the unit (e.g., "101" or "HSR2")
      propertyType: 'Commercial' | 'Residential'; // Type of property
      ownerDetails: string; // Details about the owner
      bankDetails?: string; // Optional bank details
      createdAt: Date; // Firestore Timestamp
      updatedAt: Date; // Firestore Timestamp
    }
    ```

---

## Step 2: Update the Component to Store unitNumber in State

1. **Declare a New State Variable:**  
   Add a new state variable for `unitNumber` in your component (e.g., in `page.tsx`):

    ```typescript
    const [unitNumber, setUnitNumber] = useState(""); // Add this line along with other state variables
    ```

2. **Modify the onChange Handler for the `<select>` Input:**  
   Update the handler for the unit selection so that when a unit is selected, both the `unitId` and `unitNumber` are updated from the selected unit object:

    ```typescript
    <select
        id="unitId"
        value={unitId}
        onChange={(e) => {
            const selectedUnitId = e.target.value;
            setUnitId(selectedUnitId);

            // Find the selected unit from rentalInventory to get the unitNumber
            const selectedUnit = rentalInventory.find(unit => unit.id === selectedUnitId);
            if (selectedUnit) {
                setUnitNumber(selectedUnit.unitNumber); // Set unitNumber state
            } else {
                setUnitNumber(""); // Or handle the case where the unit is not found
                console.warn("Selected unit not found in rentalInventory");
            }
        }}
        className={inputClass}
        required
        disabled={editingLeaseId !== null} // Cannot change unit when editing
    >
        {/* ... options ... */}
    </select>
    ```

---

## Step 3: Modify handleSubmit to Use unitNumber from State

1. **Update the handleSubmit Function:**  
   In your `handleSubmit` function, use the `unitNumber` state variable when creating `leaseData` instead of calling a separate function to retrieve it:

    ```typescript
    try {
        const leaseData = {
            unitId,
            unitNumber: unitNumber, // Use unitNumber directly from state
            tenantName: tenantName.trim(),
            // ... other lease data ...
        };

        // Log the leaseData for debugging purposes
        console.log('Lease Data:', leaseData);

        // ... rest of handleSubmit logic, e.g., addLease or updateLease ...
    } catch (error: any) {
        setFormError(error.message || `An error occurred while ${editingLeaseId ? 'updating' : 'saving'} the lease`);
    }
    ```

---

## Step 4: Remove or Update the getUnitNumber Function

1. **Update the Leases Table Display:**  
   In your leases table, where you previously used `getUnitNumber(lease.unitId)`, update the code to directly display `lease.unitNumber`:

    ```typescript
    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
        {lease.unitNumber} {/* Directly use lease.unitNumber */}
    </td>
    ```

2. **Evaluate the getUnitNumber Function:**  
   If `getUnitNumber` was solely used to display the unit number, consider removing it to simplify your code. If you still need it elsewhere, ensure it is used only when necessary.

---

## Debugging and Verification

- **Console Logging:**  
  Keep the console log in your `handleSubmit` function to verify that the `leaseData` object contains the correct `unitNumber`:

  ```typescript
  console.log('Lease Data:', leaseData);
